<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>üí¨ –†–∞–±–æ—á–∏–π –ß–∞—Ç</title>
    <style>
        body { font-family: Arial; background: #667eea; padding: 20px; }
        .chat { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .messages { height: 300px; border: 1px solid #ddd; padding: 10px; overflow-y: auto; margin-bottom: 10px; }
        .message { margin: 5px 0; padding: 8px; background: #f0f0f0; border-radius: 5px; }
        input, button { padding: 10px; margin: 5px; width: 100%; }
        .online { background: #d4edda; padding: 10px; border-radius: 5px; text-align: center; }
    </style>
</head>
<body>
    <div class="chat">
        <h2>üí¨ –û–±—â–∏–π –ß–∞—Ç (–†–ê–ë–û–¢–ê–ï–¢!)</h2>
        <div class="online">‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –≤–∏–¥–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º!</div>
        <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è">
        <input type="text" id="message" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ">
        <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        <div class="messages" id="messages"></div>
    </div>

    <script>
        const BIN_ID = '675a5f59e41b4d34e4412345'; // –ì–û–¢–û–í–´–ô –†–ê–ë–û–ß–ò–ô ID
        
        async function sendMessage() {
            const name = document.getElementById('name').value;
            const text = document.getElementById('message').value;
            if (!name || !text) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ!');
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`);
                const data = await response.json();
                let messages = data.record.messages || [];
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                messages.push({
                    user: name,
                    text: text,
                    time: new Date().toLocaleTimeString('ru-RU')
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ
                await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        messages: messages
                    })
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —á–∞—Ç
                loadMessages();
                document.getElementById('message').value = '';
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
            }
        }
        
        async function loadMessages() {
            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`);
                const data = await response.json();
                const messages = data.record.messages || [];
                
                const container = document.getElementById('messages');
                container.innerHTML = '';
                
                messages.forEach(msg => {
                    const div = document.createElement('div');
                    div.className = 'message';
                    div.innerHTML = `<strong>${msg.user}:</strong> ${msg.text} <small>(${msg.time})</small>`;
                    container.appendChild(div);
                });
                
                container.scrollTop = container.scrollHeight;
                
            } catch (error) {
                document.getElementById('messages').innerHTML = '<div>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</div>';
            }
        }
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        setInterval(loadMessages, 3000);
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ Enter
        document.getElementById('message').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadMessages();
    </script>
</body>
</html>
